
CREATE OR REPLACE TRIGGER "CHRT_SMTFOMGR"."ACCOUNT"
AFTER INSERT OR UPDATE ON CHRT_SMTFOMGR.ACCOUNT
FOR EACH ROW
DECLARE 
V_ACCOUNT_NUMBER VARCHAR2(16); 
V_CUSTOMER_ACC_NUMBER VARCHAR2(13); 
V_CUSTOMER_NAME VARCHAR2(200); 
V_CUSTOMER_TYPE_ID NUMBER; 
V_ADDRESS_LINE1 VARCHAR2(500); 
V_ADDRESS_LINE2 VARCHAR2(500); 
V_PHONE_NUMBER_1 VARCHAR2(10); 
V_PHONE_NUMBER_2 VARCHAR2(10); 
V_EMAIL_ADDRESS VARCHAR2(500); 
V_PERSONAL_PHONE_NUMBER VARCHAR2(10); 
V_CITY VARCHAR2(64); 
V_STATE VARCHAR2(3); 
V_ZIP VARCHAR2(10); 
V_SITE VARCHAR2(4); 
V_ESCALATION_FLAG_ACCOUNT CHAR(1); 
V_IS_EMAIL_ENABLED CHAR(1); 
V_IS_EMAIL_CHANGED_IN_APP CHAR(1); 
V_ADDED_TS TIMESTAMP(6); 
V_MODIFIED_TS TIMESTAMP(6); 
V_TIME_ZONE_ID NUMBER; 
V_LEGACY_COMPANY_ID NUMBER; 
V_ACCOUNT_SOURCE_ID NUMBER;
BEGIN
IF INSERTING THEN
INSERT INTO CHRT_SMTFOMGR.ACCOUNT_BACKUP
(ACCOUNT_ID,ACCOUNT_NUMBER,CUSTOMER_ACC_NUMBER,CUSTOMER_NAME,CUSTOMER_TYPE_ID,ADDRESS_LINE1,ADDRESS_LINE2,PHONE_NUMBER_1,PHONE_NUMBER_2,EMAIL_ADDRESS,PERSONAL_PHONE_NUMBER,CITY,STATE,ZIP,SITE,ESCALATION_FLAG_ACCOUNT,IS_EMAIL_ENABLED,IS_EMAIL_CHANGED_IN_APP,ADDED_TS,MODIFIED_TS,TIME_ZONE_ID,LEGACY_COMPANY_ID,ACCOUNT_SOURCE_ID)
VALUES
(:NEW.ACCOUNT_ID, :NEW.ACCOUNT_NUMBER, :NEW.CUSTOMER_ACC_NUMBER, :NEW.CUSTOMER_NAME, :NEW.CUSTOMER_TYPE_ID, :NEW.ADDRESS_LINE1, :NEW.ADDRESS_LINE2, :NEW.PHONE_NUMBER_1, :NEW.PHONE_NUMBER_2, :NEW.EMAIL_ADDRESS, :NEW.PERSONAL_PHONE_NUMBER, :NEW.CITY, :NEW.STATE, :NEW.ZIP, :NEW.SITE, :NEW.ESCALATION_FLAG_ACCOUNT, :NEW.IS_EMAIL_ENABLED, :NEW.IS_EMAIL_CHANGED_IN_APP, :NEW.ADDED_TS, :NEW.MODIFIED_TS, :NEW.TIME_ZONE_ID, :NEW.LEGACY_COMPANY_ID, :NEW.ACCOUNT_SOURCE_ID) ;
ELSIF UPDATING THEN
SELECT ACCOUNT_NUMBER,CUSTOMER_ACC_NUMBER,CUSTOMER_NAME,CUSTOMER_TYPE_ID,ADDRESS_LINE1,ADDRESS_LINE2,PHONE_NUMBER_1,PHONE_NUMBER_2,EMAIL_ADDRESS,PERSONAL_PHONE_NUMBER,CITY,STATE,ZIP,SITE,ESCALATION_FLAG_ACCOUNT,IS_EMAIL_ENABLED,IS_EMAIL_CHANGED_IN_APP,ADDED_TS,MODIFIED_TS,TIME_ZONE_ID,LEGACY_COMPANY_ID,ACCOUNT_SOURCE_ID 
INTO V_ACCOUNT_NUMBER, V_CUSTOMER_ACC_NUMBER, V_CUSTOMER_NAME, V_CUSTOMER_TYPE_ID, V_ADDRESS_LINE1, V_ADDRESS_LINE2, V_PHONE_NUMBER_1, V_PHONE_NUMBER_2, V_EMAIL_ADDRESS, V_PERSONAL_PHONE_NUMBER, V_CITY, V_STATE, V_ZIP, V_SITE, V_ESCALATION_FLAG_ACCOUNT, V_IS_EMAIL_ENABLED, V_IS_EMAIL_CHANGED_IN_APP, V_ADDED_TS, V_MODIFIED_TS, V_TIME_ZONE_ID, V_LEGACY_COMPANY_ID, V_ACCOUNT_SOURCE_ID
FROM ACCOUNT WHERE ACCOUNT_ID = :NEW.ACCOUNT_ID
UPDATE CHRT_SMTFOMGR.ACCOUNT SET 
ACCOUNT_NUMBER = V_ACCOUNT_NUMBER,
CUSTOMER_ACC_NUMBER = V_CUSTOMER_ACC_NUMBER,
CUSTOMER_NAME = V_CUSTOMER_NAME,
CUSTOMER_TYPE_ID = V_CUSTOMER_TYPE_ID,
ADDRESS_LINE1 = V_ADDRESS_LINE1,
ADDRESS_LINE2 = V_ADDRESS_LINE2,
PHONE_NUMBER_1 = V_PHONE_NUMBER_1,
PHONE_NUMBER_2 = V_PHONE_NUMBER_2,
EMAIL_ADDRESS = V_EMAIL_ADDRESS,
PERSONAL_PHONE_NUMBER = V_PERSONAL_PHONE_NUMBER,
CITY = V_CITY,
STATE = V_STATE,
ZIP = V_ZIP,
SITE = V_SITE,
ESCALATION_FLAG_ACCOUNT = V_ESCALATION_FLAG_ACCOUNT,
IS_EMAIL_ENABLED = V_IS_EMAIL_ENABLED,
IS_EMAIL_CHANGED_IN_APP = V_IS_EMAIL_CHANGED_IN_APP,
ADDED_TS = V_ADDED_TS,
MODIFIED_TS = V_MODIFIED_TS,
TIME_ZONE_ID = V_TIME_ZONE_ID,
LEGACY_COMPANY_ID = V_LEGACY_COMPANY_ID,
ACCOUNT_SOURCE_ID = V_ACCOUNT_SOURCE_ID
WHERE ACCOUNT_ID = :NEW.ACCOUNT_ID;
END IF;
END;
/
